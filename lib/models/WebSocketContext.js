"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class WebSocketContext {
    constructor() { }
    static getInstance() {
        return WebSocketContext._instance;
    }
    getWebsocket() {
        return WebSocketContext._websocket;
    }
    static init(websocket) {
        WebSocketContext._websocket = websocket;
        websocket.on('connection', (ws, req, head) => {
            WebSocketContext._ows = ws;
            WebSocketContext._req = req;
            WebSocketContext._head = head;
            console.log(req.connection.remoteAddress);
            ws.on('open', () => {
                console.log('connected');
            });
            ws.on('close', () => {
                console.log('disconnected');
            });
            ws.on('message', (data) => {
                console.log('message', data);
            });
            ws.on('error', (err) => {
                console.log('error', err);
                throw err;
            });
        });
    }
}
WebSocketContext._instance = new WebSocketContext();
exports.default = WebSocketContext;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ViU29ja2V0Q29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbIm1vZGVscy9XZWJTb2NrZXRDb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsTUFBcUIsZ0JBQWdCO0lBU2pDLGdCQUF1QixDQUFDO0lBUGpCLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLE9BQU8sZ0JBQWdCLENBQUMsU0FBUyxDQUFDO0lBQ3BDLENBQUM7SUFNTSxZQUFZO1FBQ2pCLE9BQU8sZ0JBQWdCLENBQUMsVUFBVSxDQUFDO0lBQ3JDLENBQUM7SUFDTSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVM7UUFDMUIsZ0JBQWdCLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztRQUN4QyxTQUFTLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7WUFDM0MsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztZQUMzQixnQkFBZ0IsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO1lBQzVCLGdCQUFnQixDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDOUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQzFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtnQkFDZixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQzdCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsRUFBRSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO2dCQUNoQixPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ2hDLENBQUMsQ0FBQyxDQUFDO1lBQ0gsRUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDdEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDakMsQ0FBQyxDQUFDLENBQUM7WUFDSCxFQUFFLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNuQixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDMUIsTUFBTSxHQUFHLENBQUM7WUFDZCxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ0gsQ0FBQzs7QUFqQ2MsMEJBQVMsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUM7QUFEdEQsbUNBbUNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgV2ViU29ja2V0IGZyb20gJ3dzJztcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdlYlNvY2tldENvbnRleHQge1xuICAgIHByaXZhdGUgc3RhdGljIF9pbnN0YW5jZSA9IG5ldyBXZWJTb2NrZXRDb250ZXh0KCk7XG4gICAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBXZWJTb2NrZXRDb250ZXh0IHtcbiAgICAgIHJldHVybiBXZWJTb2NrZXRDb250ZXh0Ll9pbnN0YW5jZTtcbiAgICB9XG4gICAgcHJpdmF0ZSBzdGF0aWMgX3dlYnNvY2tldDtcbiAgICBwcml2YXRlIHN0YXRpYyBfb3dzOiBXZWJTb2NrZXQuU2VydmVyO1xuICAgIHByaXZhdGUgc3RhdGljIF9yZXE6IGFueTtcbiAgICBwcml2YXRlIHN0YXRpYyBfaGVhZDogYW55O1xuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxuICAgIHB1YmxpYyBnZXRXZWJzb2NrZXQoKTogV2ViU29ja2V0LlNlcnZlciB7XG4gICAgICByZXR1cm4gV2ViU29ja2V0Q29udGV4dC5fd2Vic29ja2V0O1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGluaXQod2Vic29ja2V0KSB7XG4gICAgICBXZWJTb2NrZXRDb250ZXh0Ll93ZWJzb2NrZXQgPSB3ZWJzb2NrZXQ7XG4gICAgICB3ZWJzb2NrZXQub24oJ2Nvbm5lY3Rpb24nLCAod3MsIHJlcSwgaGVhZCkgPT4ge1xuICAgICAgICBXZWJTb2NrZXRDb250ZXh0Ll9vd3MgPSB3cztcbiAgICAgICAgV2ViU29ja2V0Q29udGV4dC5fcmVxID0gcmVxO1xuICAgICAgICBXZWJTb2NrZXRDb250ZXh0Ll9oZWFkID0gaGVhZDtcbiAgICAgICAgY29uc29sZS5sb2cocmVxLmNvbm5lY3Rpb24ucmVtb3RlQWRkcmVzcyk7XG4gICAgICAgIHdzLm9uKCdvcGVuJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3RlZCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgd3Mub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3RlZCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgd3Mub24oJ21lc3NhZ2UnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ21lc3NhZ2UnLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdzLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicsIGVycik7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==