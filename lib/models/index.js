"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("reflect-metadata");
/* istanbul ignore next */
class ORMContext {
    constructor() {
        this.context = ORMContext.getContext();
    }
    getBean(name) {
        return this.context.getBean(name);
    }
    getConnectionNames() {
        return Object.keys(this.context._config.database);
    }
    static getConnectionNames() {
        return Object.keys(ORMContext.orm._config.database);
    }
    static async init(pathdb, pathBeansPath) {
        // tslint:disable-next-line:no-null-keyword
        this.orm = null;
        this.orm = await require('gama-orm')({
            beansPath: pathBeansPath,
            printSQL: true,
            database: pathdb
        });
        return this.orm;
    }
    static getBean(name) {
        return this.orm.getBean(name);
    }
    /**
     * 注意!!這是為了Mock注入的hook,單純為了注入依賴,非常規使用
     * 請不要隨意使用這個方法
     * @static
     * @param {*} mockOrm
     * @memberof Context
     */
    static setMockContext(mockOrm) {
        this.orm = mockOrm;
    }
    static getContext() {
        return ORMContext.orm;
    }
}
exports.ORMContext = ORMContext;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiLi9zcmMvIiwic291cmNlcyI6WyJtb2RlbHMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0QkFBMEI7QUFFMUIsMEJBQTBCO0FBQzFCLE1BQWEsVUFBVTtJQUduQjtRQUNJLElBQUksQ0FBQyxPQUFPLEdBQUcsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQzNDLENBQUM7SUFDTSxPQUFPLENBQUMsSUFBWTtRQUN2QixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFDTSxrQkFBa0I7UUFDckIsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFDTSxNQUFNLENBQUMsa0JBQWtCO1FBQzVCLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRU0sTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLGFBQWE7UUFDMUMsMkNBQTJDO1FBQzNDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO1FBQ2hCLElBQUksQ0FBQyxHQUFHLEdBQUcsTUFBTSxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDakMsU0FBUyxFQUFFLGFBQWE7WUFDeEIsUUFBUSxFQUFFLElBQUk7WUFDZCxRQUFRLEVBQUUsTUFBTTtTQUNuQixDQUFDLENBQUM7UUFFSCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDcEIsQ0FBQztJQUNNLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBWTtRQUM5QixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRDs7Ozs7O09BTUc7SUFDSSxNQUFNLENBQUMsY0FBYyxDQUFDLE9BQVk7UUFDckMsSUFBSSxDQUFDLEdBQUcsR0FBRyxPQUFPLENBQUM7SUFDdkIsQ0FBQztJQUNNLE1BQU0sQ0FBQyxVQUFVO1FBQ3BCLE9BQU8sVUFBVSxDQUFDLEdBQUcsQ0FBQztJQUMxQixDQUFDO0NBRUo7QUE3Q0QsZ0NBNkNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdyZWZsZWN0LW1ldGFkYXRhJztcblxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbmV4cG9ydCBjbGFzcyBPUk1Db250ZXh0IHtcbiAgICBwdWJsaWMgY29udGV4dDogYW55O1xuICAgIHB1YmxpYyBzdGF0aWMgb3JtOiBhbnk7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IE9STUNvbnRleHQuZ2V0Q29udGV4dCgpO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0QmVhbihuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5nZXRCZWFuKG5hbWUpO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0Q29ubmVjdGlvbk5hbWVzKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5jb250ZXh0Ll9jb25maWcuZGF0YWJhc2UpO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldENvbm5lY3Rpb25OYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKE9STUNvbnRleHQub3JtLl9jb25maWcuZGF0YWJhc2UpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgaW5pdChwYXRoZGIsIHBhdGhCZWFuc1BhdGgpIHtcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW51bGwta2V5d29yZFxuICAgICAgICB0aGlzLm9ybSA9IG51bGw7XG4gICAgICAgIHRoaXMub3JtID0gYXdhaXQgcmVxdWlyZSgnZ2FtYS1vcm0nKSh7XG4gICAgICAgICAgICBiZWFuc1BhdGg6IHBhdGhCZWFuc1BhdGgsXG4gICAgICAgICAgICBwcmludFNRTDogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGFiYXNlOiBwYXRoZGJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMub3JtO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldEJlYW4obmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9ybS5nZXRCZWFuKG5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOazqOaEjyEh6YCZ5piv54K65LqGTW9ja+azqOWFpeeahGhvb2ss5Zau57SU54K65LqG5rOo5YWl5L6d6LO0LOmdnuW4uOimj+S9v+eUqFxuICAgICAqIOiri+S4jeimgemaqOaEj+S9v+eUqOmAmeWAi+aWueazlVxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAcGFyYW0geyp9IG1vY2tPcm1cbiAgICAgKiBAbWVtYmVyb2YgQ29udGV4dFxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgc2V0TW9ja0NvbnRleHQobW9ja09ybTogYW55KSB7XG4gICAgICAgIHRoaXMub3JtID0gbW9ja09ybTtcbiAgICB9XG4gICAgcHVibGljIHN0YXRpYyBnZXRDb250ZXh0KCkge1xuICAgICAgICByZXR1cm4gT1JNQ29udGV4dC5vcm07XG4gICAgfVxuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRyYW5zYWN0aW9uIHtcbiAgICBiZWdpbigpOiBQcm9taXNlPGFueT47XG4gICAgY29tbWl0KCk6IFByb21pc2U8YW55PjtcbiAgICByb2xsYmFjaygpOiBQcm9taXNlPGFueT47XG4gICAgZ2V0RGFvKHRhYmxlTmFtZTogc3RyaW5nKTogYW55O1xufVxuIl19