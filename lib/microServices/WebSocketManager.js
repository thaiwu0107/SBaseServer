"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const log4js = require("koa-log4");
require("reflect-metadata");
const WebSocketContext_1 = require("../models/WebSocketContext");
const _log = log4js.getLogger('WebSocketManager');
class WebSocketManager {
    constructor() {
        this._context = WebSocketContext_1.default.getInstance().getWebsocket();
        this._context.on('connection', (ws, req, head) => {
            this._ows = ws;
            this._req = req;
            this._head = head;
            console.log(req.connection.remoteAddress);
            ws.on('open', () => {
                console.log('connected');
            });
            ws.on('close', () => {
                console.log('disconnected');
            });
            ws.on('message', (data) => {
                console.log('message', data);
            });
        });
    }
}
exports.default = WebSocketManager;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2ViU29ja2V0TWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbIm1pY3JvU2VydmljZXMvV2ViU29ja2V0TWFuYWdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUNuQyw0QkFBMEI7QUFFMUIsaUVBQTBEO0FBRTFELE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNsRCxNQUFxQixnQkFBZ0I7SUFLakM7UUFDSSxJQUFJLENBQUMsUUFBUSxHQUFHLDBCQUFnQixDQUFDLFdBQVcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQzlELElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7WUFDN0MsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7WUFDZixJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztZQUNoQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDMUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO2dCQUNmLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUM7WUFDSCxFQUFFLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7Z0JBQ2hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDaEMsQ0FBQyxDQUFDLENBQUM7WUFDSCxFQUFFLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUN0QixPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNqQyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztDQUNKO0FBdkJELG1DQXVCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGxvZzRqcyBmcm9tICdrb2EtbG9nNCc7XG5pbXBvcnQgJ3JlZmxlY3QtbWV0YWRhdGEnO1xuaW1wb3J0ICogYXMgV2ViU29ja2V0IGZyb20gJ3dzJztcbmltcG9ydCBXZWJTb2NrZXRDb250ZXh0IGZyb20gJy4uL21vZGVscy9XZWJTb2NrZXRDb250ZXh0JztcblxuY29uc3QgX2xvZyA9IGxvZzRqcy5nZXRMb2dnZXIoJ1dlYlNvY2tldE1hbmFnZXInKTtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdlYlNvY2tldE1hbmFnZXIge1xuICAgIHByb3RlY3RlZCBfY29udGV4dDogV2ViU29ja2V0LlNlcnZlcjtcbiAgICBwcm90ZWN0ZWQgX293czogV2ViU29ja2V0LlNlcnZlcjtcbiAgICBwcm90ZWN0ZWQgX3JlcTogYW55O1xuICAgIHByb3RlY3RlZCBfaGVhZDogYW55O1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gV2ViU29ja2V0Q29udGV4dC5nZXRJbnN0YW5jZSgpLmdldFdlYnNvY2tldCgpO1xuICAgICAgICB0aGlzLl9jb250ZXh0Lm9uKCdjb25uZWN0aW9uJywgKHdzLCByZXEsIGhlYWQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX293cyA9IHdzO1xuICAgICAgICAgICAgdGhpcy5fcmVxID0gcmVxO1xuICAgICAgICAgICAgdGhpcy5faGVhZCA9IGhlYWQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXEuY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzKTtcbiAgICAgICAgICAgIHdzLm9uKCdvcGVuJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0ZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd3Mub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkaXNjb25uZWN0ZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd3Mub24oJ21lc3NhZ2UnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtZXNzYWdlJywgZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl19