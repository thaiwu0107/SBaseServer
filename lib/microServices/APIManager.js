"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const log4js = require("koa-log4");
const _ = require("lodash");
require("reflect-metadata");
const request_1 = require("request");
const util_1 = require("util");
const _log = log4js.getLogger('APIManger');
class APIManger {
    constructor(authData, cadata) {
        this.agentOptions = undefined;
        this.agentOptions = _.isUndefined(cadata) ? undefined : _.omitBy(cadata, _.isUndefined);
        this.auth = _.isUndefined(authData) ? undefined : _.omitBy(authData, _.isUndefined);
        const [getPm, postPm, patchPm, deletePm, putPm] = [request_1.get, request_1.post, request_1.patch, request_1.del, request_1.put].map(util_1.promisify);
        this.get = getPm;
        this.post = postPm;
        this.patch = patchPm;
        this.del = deletePm;
        this.put = putPm;
    }
    /**
     * httpGet
     */
    async httpGet(url, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.get(reqData);
    }
    /**
     * httpsGet
     */
    async httpsGet(url, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.get(reqData);
    }
    /**
     * httpPost
     */
    async httpPost(url, requestBody, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData,
            json: true,
            body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.post(reqData);
    }
    /**
     * httpsPost
     */
    async httpsPost(url, requestBody, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined),
            json: true, body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.post(reqData);
    }
    /**
     * httpPostFormData
     */
    async httpPostFormData(url, formData, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData,
            formData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.post(reqData);
    }
    /**
     * httpsPostFormData
     */
    async httpsPostFormData(url, formData, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined),
            formData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.post(reqData);
    }
    /**
     * httpPut
     */
    async httpPut(url, requestBody, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData,
            json: true,
            body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.put(reqData);
    }
    /**
     * httpsPut
     */
    async httpsPut(url, requestBody, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined),
            json: true, body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.put(reqData);
    }
    /**
     * httpPutFormData
     */
    async httpPutFormData(url, formData, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData,
            formData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.put(reqData);
    }
    /**
     * httpsPut
     */
    async httpsPutFormData(url, formData, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined), formData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.put(reqData);
    }
    /**
     * httpPatch
     */
    async httpPatch(url, requestBody, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData,
            json: true,
            body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.patch(reqData);
    }
    /**
     * httpsPatch
     */
    async httpsPatch(url, requestBody, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined),
            json: true, body: JSON.stringify(requestBody)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.patch(reqData);
    }
    /**
     * httpDelete
     */
    async httpDelete(url, params, authData) {
        const baseData = {
            url: 'http://' + url,
            auth: _.isUndefined(authData) ? this.auth : authData
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.del(reqData);
    }
    /**
     * httpsDelete
     */
    async httpsDelete(url, params, cadata) {
        const baseData = {
            url: 'http://' + url,
            agentOptions: _.isUndefined(cadata) ? this.agentOptions : _.omitBy(cadata, _.isUndefined)
        };
        const reqData = _.isUndefined(params) ? baseData : _.assign(baseData, { qs: params });
        return this.del(reqData);
    }
}
exports.default = APIManger;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQVBJTWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIuL3NyYy8iLCJzb3VyY2VzIjpbIm1pY3JvU2VydmljZXMvQVBJTWFuYWdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUFtQztBQUNuQyw0QkFBNEI7QUFDNUIsNEJBQTBCO0FBQzFCLHFDQUFxRDtBQUNyRCwrQkFBaUM7QUFFakMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUMzQyxNQUFxQixTQUFTO0lBb0IxQixZQUNJLFFBS0MsRUFDRCxNQU9DO1FBakNHLGlCQUFZLEdBT2hCLFNBQVMsQ0FBQztRQTJCVixJQUFJLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3hGLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDcEYsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsR0FBRyxDQUFDLGFBQUcsRUFBRSxjQUFJLEVBQUUsZUFBSyxFQUFFLGFBQUcsRUFBRSxhQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsZ0JBQVMsQ0FBQyxDQUFDO1FBQzlGLElBQUksQ0FBQyxHQUFHLEdBQUcsS0FBSyxDQUFDO1FBQ2pCLElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDO1FBQ25CLElBQUksQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDO1FBQ3JCLElBQUksQ0FBQyxHQUFHLEdBQUcs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QyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN0RixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUNEOztPQUVHO0lBQ0ksS0FBSyxDQUFDLFdBQVcsQ0FDcEIsR0FBVyxFQUFFLE1BQVksRUFDekIsTUFPQztRQUNELE1BQU0sUUFBUSxHQUFHO1lBQ2IsR0FBRyxFQUFFLFNBQVMsR0FBRyxHQUFHO1lBQ3BCLFlBQVksRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDO1NBQzVGLENBQUM7UUFDRixNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLEVBQUUsRUFBRSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDdEYsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzdCLENBQUM7Q0FDSjtBQTlURCw0QkE4VEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBsb2c0anMgZnJvbSAna29hLWxvZzQnO1xuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0ICdyZWZsZWN0LW1ldGFkYXRhJztcbmltcG9ydCB7IGRlbCwgZ2V0LCBwYXRjaCwgcG9zdCwgcHV0IH0gZnJvbSAncmVxdWVzdCc7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcblxuY29uc3QgX2xvZyA9IGxvZzRqcy5nZXRMb2dnZXIoJ0FQSU1hbmdlcicpO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQVBJTWFuZ2VyIHtcbiAgICBwcml2YXRlIGFnZW50T3B0aW9uczogdW5kZWZpbmVkIHwge1xuICAgICAgICBjZXJ0RmlsZT86IHN0cmluZyxcbiAgICAgICAga2V5RmlsZT86IHN0cmluZyxcbiAgICAgICAgY2E/OiBzdHJpbmcsXG4gICAgICAgIHBhc3NwaHJhc2U/OiBzdHJpbmcsXG4gICAgICAgIHNlY3VyaXR5T3B0aW9ucz86IHN0cmluZyxcbiAgICAgICAgc2VjdXJlUHJvdG9jb2w/OiBzdHJpbmdcbiAgICB9ID0gdW5kZWZpbmVkO1xuICAgIHByaXZhdGUgYXV0aDogdW5kZWZpbmVkIHwge1xuICAgICAgICB1c2VyPzogc3RyaW5nLFxuICAgICAgICBwYXNzPzogc3RyaW5nLFxuICAgICAgICBiZWFyZXI/OiBzdHJpbmcsXG4gICAgICAgIHNlbmRJbW1lZGlhdGVseT86IGJvb2xlYW5cbiAgICB9O1xuICAgIHByaXZhdGUgZ2V0O1xuICAgIHByaXZhdGUgZGVsO1xuICAgIHByaXZhdGUgcGF0Y2g7XG4gICAgcHJpdmF0ZSBwb3N0O1xuICAgIHByaXZhdGUgcHV0O1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhdXRoRGF0YT86IHtcbiAgICAgICAgICAgIHVzZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzPzogc3RyaW5nLFxuICAgICAgICAgICAgYmVhcmVyPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VuZEltbWVkaWF0ZWx5PzogYm9vbGVhblxuICAgICAgICB9LFxuICAgICAgICBjYWRhdGE/OiB7XG4gICAgICAgICAgICBjZXJ0RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGtleUZpbGU/OiBzdHJpbmcsXG4gICAgICAgICAgICBjYT86IHN0cmluZyxcbiAgICAgICAgICAgIHBhc3NwaHJhc2U/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZWN1cml0eU9wdGlvbnM/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZWN1cmVQcm90b2NvbD86IHN0cmluZ1xuICAgICAgICB9KSB7XG4gICAgICAgIHRoaXMuYWdlbnRPcHRpb25zID0gXy5pc1VuZGVmaW5lZChjYWRhdGEpID8gdW5kZWZpbmVkIDogXy5vbWl0QnkoY2FkYXRhLCBfLmlzVW5kZWZpbmVkKTtcbiAgICAgICAgdGhpcy5hdXRoID0gXy5pc1VuZGVmaW5lZChhdXRoRGF0YSkgPyB1bmRlZmluZWQgOiBfLm9taXRCeShhdXRoRGF0YSwgXy5pc1VuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IFtnZXRQbSwgcG9zdFBtLCBwYXRjaFBtLCBkZWxldGVQbSwgcHV0UG1dID0gW2dldCwgcG9zdCwgcGF0Y2gsIGRlbCwgcHV0XS5tYXAocHJvbWlzaWZ5KTtcbiAgICAgICAgdGhpcy5nZXQgPSBnZXRQbTtcbiAgICAgICAgdGhpcy5wb3N0ID0gcG9zdFBtO1xuICAgICAgICB0aGlzLnBhdGNoID0gcGF0Y2hQbTtcbiAgICAgICAgdGhpcy5kZWwgPSBkZWxldGVQbTtcbiAgICAgICAgdGhpcy5wdXQgPSBwdXRQbTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cEdldFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBodHRwR2V0KFxuICAgICAgICB1cmw6IHN0cmluZyxcbiAgICAgICAgcGFyYW1zPzogYW55LFxuICAgICAgICBhdXRoRGF0YT86IHtcbiAgICAgICAgICAgIHVzZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzPzogc3RyaW5nLFxuICAgICAgICAgICAgYmVhcmVyPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VuZEltbWVkaWF0ZWx5PzogYm9vbGVhblxuICAgICAgICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgYmFzZURhdGEgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vJyArIHVybCxcbiAgICAgICAgICAgIGF1dGg6IF8uaXNVbmRlZmluZWQoYXV0aERhdGEpID8gdGhpcy5hdXRoIDogYXV0aERhdGFcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVxRGF0YSA9IF8uaXNVbmRlZmluZWQocGFyYW1zKSA/IGJhc2VEYXRhIDogXy5hc3NpZ24oYmFzZURhdGEsIHsgcXM6IHBhcmFtcyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KHJlcURhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBodHRwc0dldFxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBodHRwc0dldChcbiAgICAgICAgdXJsOiBzdHJpbmcsIHBhcmFtcz86IGFueSxcbiAgICAgICAgY2FkYXRhPzoge1xuICAgICAgICAgICAgY2VydEZpbGU/OiBzdHJpbmcsXG4gICAgICAgICAgICBrZXlGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAgY2E/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzcGhyYXNlPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VjdXJpdHlPcHRpb25zPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VjdXJlUHJvdG9jb2w/OiBzdHJpbmdcbiAgICAgICAgfSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGNvbnN0IGJhc2VEYXRhID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cDovLycgKyB1cmwsXG4gICAgICAgICAgICBhZ2VudE9wdGlvbnM6IF8uaXNVbmRlZmluZWQoY2FkYXRhKSA/IHRoaXMuYWdlbnRPcHRpb25zIDogXy5vbWl0QnkoY2FkYXRhLCBfLmlzVW5kZWZpbmVkKVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXFEYXRhID0gXy5pc1VuZGVmaW5lZChwYXJhbXMpID8gYmFzZURhdGEgOiBfLmFzc2lnbihiYXNlRGF0YSwgeyBxczogcGFyYW1zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQocmVxRGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGh0dHBQb3N0XG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGh0dHBQb3N0KFxuICAgICAgICB1cmw6IHN0cmluZywgcmVxdWVzdEJvZHksIHBhcmFtcz86IGFueSwgYXV0aERhdGE/OiB7XG4gICAgICAgICAgICB1c2VyPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzcz86IHN0cmluZyxcbiAgICAgICAgICAgIGJlYXJlcj86IHN0cmluZyxcbiAgICAgICAgICAgIHNlbmRJbW1lZGlhdGVseT86IGJvb2xlYW5cbiAgICAgICAgfSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGNvbnN0IGJhc2VEYXRhID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cDovLycgKyB1cmwsXG4gICAgICAgICAgICBhdXRoOiBfLmlzVW5kZWZpbmVkKGF1dGhEYXRhKSA/IHRoaXMuYXV0aCA6IGF1dGhEYXRhLFxuICAgICAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXFEYXRhID0gXy5pc1VuZGVmaW5lZChwYXJhbXMpID8gYmFzZURhdGEgOiBfLmFzc2lnbihiYXNlRGF0YSwgeyBxczogcGFyYW1zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0KHJlcURhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBodHRwc1Bvc3RcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cHNQb3N0KFxuICAgICAgICB1cmw6IHN0cmluZywgcmVxdWVzdEJvZHksIHBhcmFtcz86IGFueSxcbiAgICAgICAgY2FkYXRhPzoge1xuICAgICAgICAgICAgY2VydEZpbGU/OiBzdHJpbmcsXG4gICAgICAgICAgICBrZXlGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAgY2E/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzcGhyYXNlPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VjdXJpdHlPcHRpb25zPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VjdXJlUHJvdG9jb2w/OiBzdHJpbmdcbiAgICAgICAgfSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGNvbnN0IGJhc2VEYXRhID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cDovLycgKyB1cmwsXG4gICAgICAgICAgICBhZ2VudE9wdGlvbnM6IF8uaXNVbmRlZmluZWQoY2FkYXRhKSA/IHRoaXMuYWdlbnRPcHRpb25zIDogXy5vbWl0QnkoY2FkYXRhLCBfLmlzVW5kZWZpbmVkKSxcbiAgICAgICAgICAgIGpzb246IHRydWUsIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXFEYXRhID0gXy5pc1VuZGVmaW5lZChwYXJhbXMpID8gYmFzZURhdGEgOiBfLmFzc2lnbihiYXNlRGF0YSwgeyBxczogcGFyYW1zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0KHJlcURhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBodHRwUG9zdEZvcm1EYXRhXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGh0dHBQb3N0Rm9ybURhdGEoXG4gICAgICAgIHVybDogc3RyaW5nLCBmb3JtRGF0YSwgcGFyYW1zPzogYW55LCBhdXRoRGF0YT86IHtcbiAgICAgICAgICAgIHVzZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzPzogc3RyaW5nLFxuICAgICAgICAgICAgYmVhcmVyPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VuZEltbWVkaWF0ZWx5PzogYm9vbGVhblxuICAgICAgICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgYmFzZURhdGEgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vJyArIHVybCxcbiAgICAgICAgICAgIGF1dGg6IF8uaXNVbmRlZmluZWQoYXV0aERhdGEpID8gdGhpcy5hdXRoIDogYXV0aERhdGEsXG4gICAgICAgICAgICBmb3JtRGF0YVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXFEYXRhID0gXy5pc1VuZGVmaW5lZChwYXJhbXMpID8gYmFzZURhdGEgOiBfLmFzc2lnbihiYXNlRGF0YSwgeyBxczogcGFyYW1zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0KHJlcURhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBodHRwc1Bvc3RGb3JtRGF0YVxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBodHRwc1Bvc3RGb3JtRGF0YShcbiAgICAgICAgdXJsOiBzdHJpbmcsIGZvcm1EYXRhLCBwYXJhbXM/OiBhbnksXG4gICAgICAgIGNhZGF0YT86IHtcbiAgICAgICAgICAgIGNlcnRGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAga2V5RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGNhPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzc3BocmFzZT86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyaXR5T3B0aW9ucz86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyZVByb3RvY29sPzogc3RyaW5nXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYWdlbnRPcHRpb25zOiBfLmlzVW5kZWZpbmVkKGNhZGF0YSkgPyB0aGlzLmFnZW50T3B0aW9ucyA6IF8ub21pdEJ5KGNhZGF0YSwgXy5pc1VuZGVmaW5lZCksXG4gICAgICAgICAgICBmb3JtRGF0YVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZXFEYXRhID0gXy5pc1VuZGVmaW5lZChwYXJhbXMpID8gYmFzZURhdGEgOiBfLmFzc2lnbihiYXNlRGF0YSwgeyBxczogcGFyYW1zIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0KHJlcURhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBodHRwUHV0XG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGh0dHBQdXQoXG4gICAgICAgIHVybDogc3RyaW5nLCByZXF1ZXN0Qm9keSwgcGFyYW1zPzogYW55LFxuICAgICAgICBhdXRoRGF0YT86IHtcbiAgICAgICAgICAgIHVzZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBwYXNzPzogc3RyaW5nLFxuICAgICAgICAgICAgYmVhcmVyPzogc3RyaW5nLFxuICAgICAgICAgICAgc2VuZEltbWVkaWF0ZWx5PzogYm9vbGVhblxuICAgICAgICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgYmFzZURhdGEgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vJyArIHVybCxcbiAgICAgICAgICAgIGF1dGg6IF8uaXNVbmRlZmluZWQoYXV0aERhdGEpID8gdGhpcy5hdXRoIDogYXV0aERhdGEsXG4gICAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcURhdGEgPSBfLmlzVW5kZWZpbmVkKHBhcmFtcykgPyBiYXNlRGF0YSA6IF8uYXNzaWduKGJhc2VEYXRhLCB7IHFzOiBwYXJhbXMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dChyZXFEYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cHNQdXRcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cHNQdXQoXG4gICAgICAgIHVybDogc3RyaW5nLCByZXF1ZXN0Qm9keSwgcGFyYW1zPzogYW55LFxuICAgICAgICBjYWRhdGE/OiB7XG4gICAgICAgICAgICBjZXJ0RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGtleUZpbGU/OiBzdHJpbmcsXG4gICAgICAgICAgICBjYT86IHN0cmluZyxcbiAgICAgICAgICAgIHBhc3NwaHJhc2U/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZWN1cml0eU9wdGlvbnM/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZWN1cmVQcm90b2NvbD86IHN0cmluZ1xuICAgICAgICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgYmFzZURhdGEgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vJyArIHVybCxcbiAgICAgICAgICAgIGFnZW50T3B0aW9uczogXy5pc1VuZGVmaW5lZChjYWRhdGEpID8gdGhpcy5hZ2VudE9wdGlvbnMgOiBfLm9taXRCeShjYWRhdGEsIF8uaXNVbmRlZmluZWQpLFxuICAgICAgICAgICAganNvbjogdHJ1ZSwgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcURhdGEgPSBfLmlzVW5kZWZpbmVkKHBhcmFtcykgPyBiYXNlRGF0YSA6IF8uYXNzaWduKGJhc2VEYXRhLCB7IHFzOiBwYXJhbXMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dChyZXFEYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cFB1dEZvcm1EYXRhXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGh0dHBQdXRGb3JtRGF0YShcbiAgICAgICAgdXJsOiBzdHJpbmcsIGZvcm1EYXRhLCBwYXJhbXM/OiBhbnksIGF1dGhEYXRhPzoge1xuICAgICAgICAgICAgdXNlcj86IHN0cmluZyxcbiAgICAgICAgICAgIHBhc3M/OiBzdHJpbmcsXG4gICAgICAgICAgICBiZWFyZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZW5kSW1tZWRpYXRlbHk/OiBib29sZWFuXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYXV0aDogXy5pc1VuZGVmaW5lZChhdXRoRGF0YSkgPyB0aGlzLmF1dGggOiBhdXRoRGF0YSxcbiAgICAgICAgICAgIGZvcm1EYXRhXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcURhdGEgPSBfLmlzVW5kZWZpbmVkKHBhcmFtcykgPyBiYXNlRGF0YSA6IF8uYXNzaWduKGJhc2VEYXRhLCB7IHFzOiBwYXJhbXMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dChyZXFEYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cHNQdXRcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cHNQdXRGb3JtRGF0YShcbiAgICAgICAgdXJsOiBzdHJpbmcsIGZvcm1EYXRhLCBwYXJhbXM/OiBhbnksXG4gICAgICAgIGNhZGF0YT86IHtcbiAgICAgICAgICAgIGNlcnRGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAga2V5RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGNhPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzc3BocmFzZT86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyaXR5T3B0aW9ucz86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyZVByb3RvY29sPzogc3RyaW5nXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYWdlbnRPcHRpb25zOiBfLmlzVW5kZWZpbmVkKGNhZGF0YSkgPyB0aGlzLmFnZW50T3B0aW9ucyA6IF8ub21pdEJ5KGNhZGF0YSwgXy5pc1VuZGVmaW5lZCksIGZvcm1EYXRhXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcURhdGEgPSBfLmlzVW5kZWZpbmVkKHBhcmFtcykgPyBiYXNlRGF0YSA6IF8uYXNzaWduKGJhc2VEYXRhLCB7IHFzOiBwYXJhbXMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dChyZXFEYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cFBhdGNoXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIGh0dHBQYXRjaChcbiAgICAgICAgdXJsOiBzdHJpbmcsIHJlcXVlc3RCb2R5LCBwYXJhbXM/OiBhbnksIGF1dGhEYXRhPzoge1xuICAgICAgICAgICAgdXNlcj86IHN0cmluZyxcbiAgICAgICAgICAgIHBhc3M/OiBzdHJpbmcsXG4gICAgICAgICAgICBiZWFyZXI/OiBzdHJpbmcsXG4gICAgICAgICAgICBzZW5kSW1tZWRpYXRlbHk/OiBib29sZWFuXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYXV0aDogXy5pc1VuZGVmaW5lZChhdXRoRGF0YSkgPyB0aGlzLmF1dGggOiBhdXRoRGF0YSxcbiAgICAgICAgICAgIGpzb246IHRydWUsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSlcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVxRGF0YSA9IF8uaXNVbmRlZmluZWQocGFyYW1zKSA/IGJhc2VEYXRhIDogXy5hc3NpZ24oYmFzZURhdGEsIHsgcXM6IHBhcmFtcyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0Y2gocmVxRGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGh0dHBzUGF0Y2hcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cHNQYXRjaChcbiAgICAgICAgdXJsOiBzdHJpbmcsIHJlcXVlc3RCb2R5LCBwYXJhbXM/OiBhbnksXG4gICAgICAgIGNhZGF0YT86IHtcbiAgICAgICAgICAgIGNlcnRGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAga2V5RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGNhPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzc3BocmFzZT86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyaXR5T3B0aW9ucz86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyZVByb3RvY29sPzogc3RyaW5nXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYWdlbnRPcHRpb25zOiBfLmlzVW5kZWZpbmVkKGNhZGF0YSkgPyB0aGlzLmFnZW50T3B0aW9ucyA6IF8ub21pdEJ5KGNhZGF0YSwgXy5pc1VuZGVmaW5lZCksXG4gICAgICAgICAgICBqc29uOiB0cnVlLCBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSlcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVxRGF0YSA9IF8uaXNVbmRlZmluZWQocGFyYW1zKSA/IGJhc2VEYXRhIDogXy5hc3NpZ24oYmFzZURhdGEsIHsgcXM6IHBhcmFtcyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0Y2gocmVxRGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGh0dHBEZWxldGVcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cERlbGV0ZShcbiAgICAgICAgdXJsOiBzdHJpbmcsIHBhcmFtcz86IGFueSwgYXV0aERhdGE/OiB7XG4gICAgICAgICAgICB1c2VyPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzcz86IHN0cmluZyxcbiAgICAgICAgICAgIGJlYXJlcj86IHN0cmluZyxcbiAgICAgICAgICAgIHNlbmRJbW1lZGlhdGVseT86IGJvb2xlYW5cbiAgICAgICAgfSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGNvbnN0IGJhc2VEYXRhID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cDovLycgKyB1cmwsXG4gICAgICAgICAgICBhdXRoOiBfLmlzVW5kZWZpbmVkKGF1dGhEYXRhKSA/IHRoaXMuYXV0aCA6IGF1dGhEYXRhXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlcURhdGEgPSBfLmlzVW5kZWZpbmVkKHBhcmFtcykgPyBiYXNlRGF0YSA6IF8uYXNzaWduKGJhc2VEYXRhLCB7IHFzOiBwYXJhbXMgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbChyZXFEYXRhKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogaHR0cHNEZWxldGVcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgaHR0cHNEZWxldGUoXG4gICAgICAgIHVybDogc3RyaW5nLCBwYXJhbXM/OiBhbnksXG4gICAgICAgIGNhZGF0YT86IHtcbiAgICAgICAgICAgIGNlcnRGaWxlPzogc3RyaW5nLFxuICAgICAgICAgICAga2V5RmlsZT86IHN0cmluZyxcbiAgICAgICAgICAgIGNhPzogc3RyaW5nLFxuICAgICAgICAgICAgcGFzc3BocmFzZT86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyaXR5T3B0aW9ucz86IHN0cmluZyxcbiAgICAgICAgICAgIHNlY3VyZVByb3RvY29sPzogc3RyaW5nXG4gICAgICAgIH0pOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBiYXNlRGF0YSA9IHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgdXJsLFxuICAgICAgICAgICAgYWdlbnRPcHRpb25zOiBfLmlzVW5kZWZpbmVkKGNhZGF0YSkgPyB0aGlzLmFnZW50T3B0aW9ucyA6IF8ub21pdEJ5KGNhZGF0YSwgXy5pc1VuZGVmaW5lZClcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVxRGF0YSA9IF8uaXNVbmRlZmluZWQocGFyYW1zKSA/IGJhc2VEYXRhIDogXy5hc3NpZ24oYmFzZURhdGEsIHsgcXM6IHBhcmFtcyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsKHJlcURhdGEpO1xuICAgIH1cbn1cbiJdfQ==